{% extends "layouts/main.html" %}
{% set title = "Your allegation of serious misconduct" %}
{% set buttonText = "Review and send" %}
{% block pageNavigation %}{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">
      <h1 class="govuk-heading-xl">{{ title }}</h1>

      {% if data.report['your-details']['section-completed'] %}
        {% set yourDetailsHref = '/report/your-details/check-answers' %}
        {% set yourDetailsStatus = data.report['your-details']['section-completed'] %}
        {% if data.report['your-details']['section-completed'] == 'completed' %}
          {% set yourDetailsTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report['your-organisation']['section-completed'] %}
        {% set yourOrganisationHref = '/report/your-organisation/check-answers' %}
        {% set yourOrganisationStatus = data.report['your-organisation']['section-completed'] %}
        {% if data.report['your-organisation']['section-completed'] == 'completed' %}
          {% set yourOrganisationTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report['teacher-details']['section-completed'] %}
        {% set teacherHref = '/report/teacher/check-answers' %}
        {% set teacherStatus = data.report['teacher-details']['section-completed'] %}
        {% if data.report['teacher-details']['section-completed'] == 'completed' %}
          {% set teacherTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report['teacher-contact-details']['section-completed'] %}
        {% set teacherContactDetailsHref = '/report/teacher/check-answers' %}
        {% set teacherContactDetailsStatus = data.report['teacher-contact-details']['section-completed'] %}
        {% if data.report['teacher-contact-details']['section-completed'] == 'completed' %}
          {% set teacherContactDetailsTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report.teacherRole.sectionCompleted %}
        {% set teacherRoleHref = '/report/teacher-role/check-answers' %}
        {% set teacherRoleStatus = data.report.teacherRole.sectionCompleted %}
        {% if data.report.teacherRole.sectionCompleted == 'completed' %}
          {% set teacherRoleTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report['allegation']['section-completed'] %}
        {% set allegationHref = '/report/allegation/check-answers' %}
        {% set allegationStatus = data.report['allegation']['section-completed'] %}
        {% if data.report['allegation']['section-completed'] == 'completed' %}
          {% set allegationTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report['previous-misconduct']['section-completed'] %}
        {% set previousAllegationsHref = '/report/previous-misconduct/check-answers' %}
        {% set previousAllegationsStatus = data.report['previous-misconduct']['section-completed'] %}
        {% if data.report['previous-misconduct']['section-completed'] == 'completed' %}
          {% set previousAllegationsTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if data.report['documentation']['section-completed'] %}
        {% set documentationHref = '/report/documentation/check-answers' %}
        {% set documentationStatus = data.report['documentation']['section-completed'] %}
        {% if data.report['documentation']['section-completed'] == 'completed' %}
          {% set documentationTagColour = 'solid' %}
        {% endif %}
      {% endif %}

      {% if isEmployer %}
        {{ appTaskList({
          sections: [{
            titleText: "About you",
            items: [{
              text: "Your details",
              href: yourDetailsHref or '/report/your-details/name',
              tag: {
                colour: yourDetailsTagColour or 'grey',
                text: yourDetailsStatus or 'Not started yet'
              }
            }, {
              text: "Your organisation",
              href: yourOrganisationHref or '/report/your-organisation/organisation',
              tag: {
                colour: yourOrganisationTagColour or 'grey',
                text: yourOrganisationStatus or 'Not started yet'
              }
            }]
          }, {
            titleText: "About the person you’re referring",
            items: [{
              text: "Personal details",
              href: teacherHref or '/report/teacher/name',
              tag: {
                colour: teacherTagColour or 'grey',
                text: teacherStatus or 'Not started yet'
              }
            }, {
              text: "Contact details",
              href: teacherContactDetailsHref or '/report/teacher-contact-details/email',
              tag: {
                colour: teacherContactDetailsTagColour or 'grey',
                text: teacherContactDetailsStatus or 'Not started yet'
              }
            }, {
              text: "About their role",
              href: teacherRoleHref or '/report/teacher-role/start-date',
              tag: {
                colour: teacherRoleTagColour or 'grey',
                text: teacherRoleStatus or 'Not started yet'
              }
            }]
          }, {
            titleText: "The allegation",
            items: [{
              text: "Details of the allegation",
              href: allegationHref or '/report/allegation/allegation',
              tag: {
                colour: allegationTagColour or 'grey',
                text: allegationStatus or 'Not started yet'
              }
            }, {
              text: "Previous allegations",
              href: previousAllegationsHref or '/report/previous-misconduct/any-previous',
              tag: {
                colour: previousAllegationsTagColour or 'grey',
                text: previousAllegationsStatus or 'Not started yet'
              }
            }, {
              text: "Evidence and supporting information",
              href: documentationHref or '/report/documentation/anything-to-upload',
              tag: {
                colour: documentationTagColour or 'grey',
                text: documentationStatus or 'Not started yet'
              }
            }]
          }]
        }) }}
      {% else %}
        {{ appTaskList({
          sections: [{
            titleText: "About you",
            items: [{
              text: "Your details",
              href: yourDetailsHref or '/report/your-details/dont-worry',
              tag: {
                colour: yourDetailsTagColour or 'grey',
                text: yourDetailsStatus or 'Not started yet'
              }
            }]
          }, {
            titleText: "About the person you’re referring",
            items: [{
              text: "Personal details",
              href: teacherHref or '/report/teacher/name',
              tag: {
                colour: teacherTagColour or 'grey',
                text: teacherStatus or 'Not started yet'
              }
            }, {
              text: "About their role",
              href: teacherRoleHref or '/report/teacher-role/know-where-they-worked',
              tag: {
                colour: teacherRoleTagColour or 'grey',
                text: teacherRoleStatus or 'Not started yet'
              }
            }]
          }, {
            titleText: "The allegation",
            items: [{
              text: "Details of the allegation",
              href: allegationHref or '/report/allegation/allegation',
              tag: {
                colour: allegationTagColour or 'grey',
                text: allegationStatus or 'Not started yet'
              }
            }, {
              text: "Evidence and supporting information",
              href: documentationHref or '/report/documentation/anything-to-upload',
              tag: {
                colour: documentationTagColour or 'grey',
                text: documentationStatus or 'Not started yet'
              }
            }]
          }]
        }) }}
      {% endif %}





      {% set html %}
        <p>
          You can delete your draft:<br />
          <a href="/report/delete">Delete your draft referral</a>
        </p>
        <p>
          Drafts are automatically deleted after 6 months of no activity. We’ll send you an email before deleting it.
        </p>
      {% endset %}

      <form method="post">
        {{ govukButton({
          text: "Review and send"
        }) }}
      </form>

      {{ govukDetails({
        summaryText: "I do not want to continue",
        html: html
      }) }}
    </div>
  </div>
{% endblock %}

